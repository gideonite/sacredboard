"use strict";
define(["knockout", "escapeHtml", "text!runs/metricsPlotter/template.html", "plotly"],
    function (ko, escapeHtml, htmlTemplate, Plotly) {
        ko.components.register("metrics-plot", {
            viewModel: function (params) {
                this.escape = escapeHtml;
                this.values = [
                    230.596878051758,
                    226.611450195313,
                    223.873291015625,
                    223.39241027832,
                    223.34733581543,
                    223.331039428711,
                    223.31916809082,
                    223.308715820313,
                    223.299194335938,
                    223.29020690918,
                    223.281448364258,
                    223.272827148438,
                    223.26432800293,
                    223.25569152832,
                    223.246963500977,
                    223.237808227539,
                    223.228088378906,
                    223.217514038086,
                    223.205612182617,
                    223.191589355469,
                    223.173828125,
                    223.14909362793,
                    223.108642578125,
                    223.02180480957,
                    222.70166015625,
                    218.269760131836,
                    211.427261352539,
                    206.558212280273,
                    202.782852172852,
                    199.980056762695,
                    197.92138671875,
                    196.339553833008,
                    195.066101074219,
                    194.007949829102,
                    193.099746704102,
                    192.298049926758,
                    191.575210571289,
                    190.912292480469,
                    190.29606628418,
                    189.716751098633,
                    189.167404174805,
                    188.642807006836,
                    188.139282226563,
                    187.654296875,
                    187.18620300293,
                    186.734451293945,
                    186.298950195313,
                    185.879837036133,
                    185.477584838867,
                    185.091873168945,
                    184.722366333008,
                    184.368270874023,
                    184.028335571289,
                    183.701171875,
                    183.385299682617,
                    183.078994750977,
                    182.780700683594,
                    182.48860168457,
                    182.201171875,
                    181.916610717773,
                    181.633224487305,
                    181.348861694336,
                    181.061111450195,
                    180.766983032227,
                    180.463088989258,
                    180.14631652832,
                    179.815475463867,
                    179.471557617188,
                    179.11701965332,
                    178.75390625,
                    178.382690429688,
                    178.003677368164,
                    177.617797851563,
                    177.22737121582,
                    176.835708618164,
                    176.445846557617,
                    176.059585571289,
                    175.677688598633,
                    175.300643920898,
                    174.928833007813,
                    174.563186645508,
                    174.203048706055,
                    173.844970703125,
                    173.481185913086,
                    173.101272583008,
                    172.70263671875,
                    172.302673339844,
                    171.925537109375,
                    171.588516235352,
                    171.303771972656,
                    171.072570800781,
                    170.885864257813,
                    170.736129760742,
                    170.621124267578,
                    170.54052734375,
                    170.493896484375,
                    170.485610961914,
                    170.560073852539,
                    170.931274414063,
                    171.462509155273,
                    171.595092773438,
                    171.26887512207,
                    170.834518432617,
                    170.505035400391,
                    170.301666259766,
                    170.192947387695,
                    170.148696899414,
                    170.147232055664,
                    170.171401977539,
                    170.204940795898,
                    170.229873657227,
                    170.226913452148,
                    170.178909301758,
                    170.074691772461,
                    169.909744262695,
                    169.680908203125,
                    169.375076293945,
                    168.956237792969,
                    168.360610961914,
                    167.530868530273,
                    166.513931274414,
                    165.474960327148,
                    164.544189453125,
                    163.779037475586,
                    163.17497253418,
                    162.693496704102,
                    162.296447753906,
                    161.956359863281,
                    161.655151367188,
                    161.380477905273,
                    161.122955322266,
                    160.873641967773,
                    160.624282836914,
                    160.368576049805,
                    160.103637695313,
                    159.827056884766,
                    159.536117553711,
                    159.274108886719,
                    159.048263549805,
                    158.83464050293,
                    158.628707885742,
                    158.428451538086,
                    158.232894897461,
                    158.042404174805,
                    157.857559204102,
                    157.678939819336,
                    157.506103515625,
                    157.337493896484,
                    157.171035766602,
                    157.005996704102,
                    156.846054077148,
                    156.6982421875,
                    156.566818237305,
                    156.43864440918,
                    156.276245117188,
                    156.068161010742,
                    155.891525268555,
                    155.878341674805,
                    156.240341186523,
                    157.097778320313,
                    156.123245239258,
                    155.366744995117,
                    155.129577636719,
                    155.032485961914,
                    154.98014831543,
                    155.08366394043,
                    155.216186523438,
                    155.351119995117,
                    155.633346557617,
                    155.732543945313,
                    155.724487304688,
                    155.091690063477,
                    154.461791992188,
                    154.253982543945,
                    154.244979858398,
                    154.320053100586,
                    154.521118164063,
                    154.724060058594,
                    154.949951171875,
                    155.327041625977,
                    155.69010925293,
                    155.758972167969,
                    155.262329101563,
                    154.713729858398,
                    154.54573059082,
                    154.748153686523,
                    155.142807006836,
                    155.9775390625,
                    159.513107299805,
                    228.315994262695,
                    168.578689575195,
                    164.663864135742,
                    164.1162109375,
                    163.283416748047,
                    162.840087890625,
                    162.626800537109,
                    162.522354125977,
                    162.474746704102,
                    162.459823608398,
                    162.483306884766
                ];
                this.steps = [
                    0,
                    5,
                    10,
                    15,
                    20,
                    25,
                    30,
                    35,
                    40,
                    45,
                    50,
                    55,
                    60,
                    65,
                    70,
                    75,
                    80,
                    85,
                    90,
                    95,
                    100,
                    105,
                    110,
                    115,
                    120,
                    125,
                    130,
                    135,
                    140,
                    145,
                    150,
                    155,
                    160,
                    165,
                    170,
                    175,
                    180,
                    185,
                    190,
                    195,
                    200,
                    205,
                    210,
                    215,
                    220,
                    225,
                    230,
                    235,
                    240,
                    245,
                    250,
                    255,
                    260,
                    265,
                    270,
                    275,
                    280,
                    285,
                    290,
                    295,
                    300,
                    305,
                    310,
                    315,
                    320,
                    325,
                    330,
                    335,
                    340,
                    345,
                    350,
                    355,
                    360,
                    365,
                    370,
                    375,
                    380,
                    385,
                    390,
                    395,
                    400,
                    405,
                    410,
                    415,
                    420,
                    425,
                    430,
                    435,
                    440,
                    445,
                    450,
                    455,
                    460,
                    465,
                    470,
                    475,
                    480,
                    485,
                    490,
                    495,
                    500,
                    505,
                    510,
                    515,
                    520,
                    525,
                    530,
                    535,
                    540,
                    545,
                    550,
                    555,
                    560,
                    565,
                    570,
                    575,
                    580,
                    585,
                    590,
                    595,
                    600,
                    605,
                    610,
                    615,
                    620,
                    625,
                    630,
                    635,
                    640,
                    645,
                    650,
                    655,
                    660,
                    665,
                    670,
                    675,
                    680,
                    685,
                    690,
                    695,
                    700,
                    705,
                    710,
                    715,
                    720,
                    725,
                    730,
                    735,
                    740,
                    745,
                    750,
                    755,
                    760,
                    765,
                    770,
                    775,
                    780,
                    785,
                    790,
                    795,
                    800,
                    805,
                    810,
                    815,
                    820,
                    825,
                    830,
                    835,
                    840,
                    845,
                    850,
                    855,
                    860,
                    865,
                    870,
                    875,
                    880,
                    885,
                    890,
                    895,
                    900,
                    905,
                    910,
                    915,
                    920,
                    925,
                    930,
                    935,
                    940,
                    945,
                    950,
                    955,
                    960,
                    965,
                    970,
                    975,
                    980,
                    985,
                    990,
                    995
                ];
            },
            template: htmlTemplate
        });
        ko.bindingHandlers.plot = {
            init: function (element, valueAccessor, allBindings, /*deprecated*/ viewModel, bindingContext) {
                var trace1 = {
                    x: bindingContext.$data.steps,
                    y: bindingContext.$data.values,
                    type: 'scatter'
                };

                var trace2 = {
                    x: [1, 2, 3, 4],
                    y: [16, 5, 11, 9],
                    type: 'scatter'
                };

                var data = [trace1, trace2];
                Plotly.newPlot('plot-graph', data);
            },
            update: function (element, valueAccessor) {
                /* empty for now */
            }
        };
    });